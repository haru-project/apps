name: haru-reasoner

services:

  bt-forest:
    image: ghcr.io/haru-project/agent-reasoner:ros2-fastdds
    command: [
      "ros2", "launch", "haru_agent_reasoner", "haru_controllers.launch.py",
      "expressivity_controller_enabled:=true",
      "gaze_controller_enabled:=true",
      "ipad_students_controller_enabled:=false",
      "ipad_teacher_controller_enabled:=false",
      "unity_controller_enabled:=false",
      "start_bt_forest_server:=true",
    ]
    env_file: ../envs/reasoner.env
    network_mode: host
    ipc: host
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
  
  context-manager:
    image: ghcr.io/haru-project/agent-reasoner:ros2-fastdds
    command: [
      "ros2", "launch", "haru_agent_reasoner", "haru_context.launch.py",
      "start_perception_postprocessors:=true",
    ]
    env_file: ../envs/reasoner.env
    network_mode: host
    ipc: host
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw

  reasoner:
    image: ghcr.io/haru-project/agent-reasoner:ros2-fastdds
    command: [
      "ros2", "launch", "haru_agent_reasoner", "haru_reasoner.launch.py",
      "reactive_rules_file_path:=/ros2_ws/src/agent_reasoner/haru_agent_reasoner/config/reactiveness/reactive_rules.json",
      "config_file:=/ros2_ws/src/agent_reasoner/haru_agent_reasoner/examples/configs/ConfigJap0.json",
      "enable_reactive:=true",
    ]
    env_file: ../envs/reasoner.env
    network_mode: host
    ipc: host
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
  
  execute-task:
    image: ghcr.io/haru-project/agent-reasoner:ros2-fastdds
    command: [
      "ros2", "action", "send_goal", "/haru_agent/new_task_raw", "haru_agent_reasoner_msgs/action/TriggerTaskExecutionRaw",
      "{json_filepath: '/ros2_ws/src/agent_reasoner/haru_agent_reasoner/examples/tasks/TaskTestBond.json', task_type: 1}",
      "-f",
    ]
    env_file: ../envs/reasoner.env
    network_mode: host
    ipc: host
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw